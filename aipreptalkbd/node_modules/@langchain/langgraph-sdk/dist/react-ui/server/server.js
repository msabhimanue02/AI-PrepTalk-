import { v4 as uuidv4 } from "uuid";
export const typedUi = (config) => {
    let collect = [];
    const runId = config.metadata?.run_id ?? config.runId;
    if (!runId)
        throw new Error("run_id is required");
    const metadata = {
        ...config.metadata,
        tags: config.tags,
        name: config.runName,
        run_id: runId,
    };
    const create = (name, props) => ({
        type: "ui",
        id: uuidv4(),
        name,
        content: props,
        additional_kwargs: metadata,
    });
    const remove = (id) => ({ type: "remove-ui", id });
    return {
        create,
        remove,
        collect,
        write: (name, props) => {
            const evt = create(name, props);
            collect.push(evt);
            config.writer?.(evt);
        },
    };
};
