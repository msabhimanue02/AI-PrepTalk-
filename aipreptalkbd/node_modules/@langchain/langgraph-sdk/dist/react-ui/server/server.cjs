"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.typedUi = void 0;
const uuid_1 = require("uuid");
const typedUi = (config) => {
    let collect = [];
    const runId = config.metadata?.run_id ?? config.runId;
    if (!runId)
        throw new Error("run_id is required");
    const metadata = {
        ...config.metadata,
        tags: config.tags,
        name: config.runName,
        run_id: runId,
    };
    const create = (name, props) => ({
        type: "ui",
        id: (0, uuid_1.v4)(),
        name,
        content: props,
        additional_kwargs: metadata,
    });
    const remove = (id) => ({ type: "remove-ui", id });
    return {
        create,
        remove,
        collect,
        write: (name, props) => {
            const evt = create(name, props);
            collect.push(evt);
            config.writer?.(evt);
        },
    };
};
exports.typedUi = typedUi;
